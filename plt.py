import numpy as np
import matplotlib.pyplot as plt
from matplotlib.pyplot import MultipleLocator

# fedavg_suiji
# no_attack = [0.0334 for _ in range(6)]
# uncertain = [0.0334, 0.1013, 0.1135, 0.2066, 0.8688, 0.8605]
# gaussian = [0.0334, 0.0502, 0.0454, 0.0518, 0.0585, 0.0150]
# label = [0.0334, 0.0332, 0.0642, 0.0847, 0.1465, 0.0963]
# krum = [0.0334, 0.0213, 0.0221, 0.0176, 0.0202, 0.0197]
# mean = [0.0334, 0.0147, 0.0358, 0.0002, 0.0120, 0.0]
# median = [0.0334, 0.0145, 0.0125, 0.0189, 0.0274, 0.0130]
# scaling = [0.0334, 0.0324, 0.0511, 0.0534, 0.0601, 0.1734]

# krum_suiji
# no_attack = [0.0524 for _ in range(6)]
# uncertain = [0.0524, 0.1584, 0.0566, 0.2574, 0.3911, 0.4205]
# gaussian = [0.0524, 0.0270, 0.0316, 0.0410, 0.0237, 0.0526]
# label = [0.0524, 0.0228, 0.0241, 0.0341, 0.0249, 0.0244]
# krum = [0.0524, 0.0313, 0.0324, 0.0438, 0.0302, 0.0443]
# mean = [0.0524, 0.0354, 0.0383, 0.0449, 0.0353, 0.0421]
# median = [0.0524, 0.0275, 0.0399, 0.0395, 0.0365, 0.0601]
# scaling = [0.0524, 0.0305, 0.0334, 0.0250, 0.0474, 0.0431]

# mean_suiji
# no_attack = [0.0296 for _ in range(6)]
# uncertain = [0.0296, 0.0841, 0.0845, 0.0669, 0.1230, 0.1251]
# gaussian = [0.0296, 0.0195, 0.0191, 0.0193, 0.0174, 0.0176]
# label = [0.0296, 0.0186, 0.0208, 0.0321, 0.0227, 0.0172]
# krum = [0.0296, 0.0198, 0.0221, 0.0218, 0.0186, 0.0177]
# mean = [0.0296, 0.0193, 0.0616, 0.0038, 0.0688, 0.2434]
# median = [0.0296, 0.0247, 0.0290, 0.0431, 0.0003, 0.0775]
# scaling = [0.0296, 0.0182, 0.0983, 0.0562, 0.1657, 0.0434]

# median_suiji
# no_attack = [0.0353 for _ in range(6)]
# uncertain = [0.0353, 0.1168, 0.0687, 0.1230, 0.1625, 0.2157]
# gaussian = [0.0353, 0.0204, 0.0180, 0.0156, 0.0185, 0.0610]
# label = [0.0353, 0.0186, 0.0190, 0.0185, 0.0207, 0.0273]
# krum = [0.0353, 0.0163, 0.0219, 0.0187, 0.0116, 0.0574]
# mean = [0.0353, 0.0239, 0.0196, 0.0495, 0.0636, 0.0842]
# median = [0.0353, 0.0176, 0.0117, 0.0505, 0.0158, 0.1310]
# scaling = [0.0353, 0.0574, 0.0230, 0.0272, 0.0466, 0.0399]

# fedavg_big
# no_attack = [0.0334 for _ in range(6)]
# uncertain = [0.0334, 0.8729, 0.9995, 1.0, 1.0, 1.0]
# gaussian = [0.0334, 0.0520, 0.0538, 0.0496, 0.0620, 0.0509]
# label = [0.0334, 0.0803, 0.0698, 0.0669, 0.2170, 0.1950]
# krum = [0.0334, 0.0456, 0.0489, 0.0516, 0.0539, 0.0628]
# mean = [0.0334, 0.0390, 0.0382, 0.0590, 0.2204, 0.4333]
# median = [0.0334, 0.0386, 0.0433, 0.0654, 0.0407, 0.1367]
# scaling = [0.0334, 0.0396, 0.0498, 0.0776, 0.1044, 0.1675]

# krum_big
# no_attack = [0.0524 for _ in range(6)]
# uncertain = [0.0524, 0.2162,  0.4182, 0.4234, 0.4369,0.4669]
# gaussian = [0.0524, 0.0701, 0.0767, 0.0448, 0.0237, 0.0309]
# label = [0.0524, 0.0282, 0.0631, 0.0807, 0.3979, 0.4032]
# krum = [0.0524, 0.0768, 0.0483, 0.1372, 0.0349, 0.0014]
# mean = [0.0524, 0.1548, 0.0752, 0.0473, 0.4242, 0.4329]
# median = [0.0524, 0.0687, 0.1066, 0.0922, 0.1276, 0.3110]
# scaling = [0.0524, 0.0549, 0.0441, 0.1572, 0.2871, 0.2663]

# mean_big
# no_attack = [0.0296 for _ in range(6)]
# uncertain = [0.0296, 0.0797,  0.0845, 0.25, 0.2619,0.3546]
# gaussian = [0.0296, 0.0537, 0.0355, 0.0442, 0.0312, 0.0248]
# label = [0.0296, 0.0519, 0.0437, 0.0266, 0.0799, 0.047]
# krum = [0.0296, 0.0511, 0.0444, 0.0449, 0.0373, 0.0271]
# mean = [0.0296, 0.0452, 0.0391, 0.0895, 0.1413, 0.1598]
# median = [0.0296, 0.0425, 0.0489, 0.0543, 0.0954, 0.0709]
# scaling = [0.0296, 0.0408, 0.0343, 0.0515, 0.0377, 0.0423]

# median_big
# no_attack = [0.0353 for _ in range(6)]
# uncertain = [0.0353, 0.0556,  0.0565, 0.0804, 0.1332,0.1946]
# gaussian = [0.0353, 0.0382, 0.0283, 0.0, 0.0308, 0.0162]
# label = [0.0353, 0.0659, 0.0256, 0.0, 0.0344, 0.0211]
# krum = [0.0353, 0.0619, 0.0389, 0.0482, 0.052, 0.032]
# mean = [0.0353, 0.0346, 0.033, 0.0, 0.0392, 0.0263]
# median = [0.0353, 0.0377, 0.0281, 0.0, 0.0306, 0.0204]
# scaling = [0.0353, 0.0402, 0.0299, 0.0348, 0.0408, 0.0287]

# fedavg_non
# no_attack = [0.0326, 0.0334, 0.0334, 0.0496, 0.062, 0.0752]
# uncertain = [1.0, 1.0, 1.0, 1.0, 0.4524, 1.0]
# gaussian = [0.0436, 0.0322, 0.0509, 0.0503, 0.0325, 0.0634]
# label = [0.0872, 0.0402, 0.1950, 0.0759, 0.0257, 0.0462]
# krum = [0.0393, 0.0394, 0.0628, 0.0828, 0.0844, 0.0729]
# mean = [0.0045, 0.0069, 0.4333, 0.0651, 0.0, 0.0]
# median = [0.0275, 0.0297, 0.1367, 0.2485, 0.0029, 0.0084]
# scaling = [0.2602, 0.0394, 0.1675, 0.0374, 0.2153, 0.05]

# krum_non
# no_attack = [0.039, 0.0545, 0.0524, 0.0, 0.0, 0.0]
# uncertain = [0.0343, 0.0338, 0.4369, 0.0, 0.9908, 0.0038]
# gaussian = [0.0435, 0.0722, 0.0369, 0.2543, 0.0, 0.0]
# label = [0.0547, 0.0524, 0.4032, 0.0458, 0.0458, 0.0]
# krum = [0.0844, 0.0645, 0.0014, 0.0783, 0.0523, 0.0689]
# mean = [0.0612, 0.0457, 0.4329, 0.0, 0.0, 0.0]
# median = [0.0196, 0.0679, 0.3110, 0.0396, 0.0, 0.0]
# scaling = [0.0452, 0.0349, 0.2663, 0.0, 0.0, 0.0]

# mean_non
# no_attack = [0.0415, 0.0445, 0.0296, 0.0413, 0.0602, 0.0588]
# uncertain = [0.1133, 0.1929, 0.3546, 0.3911, 0.8542, 0.8215]
# gaussian = [0.0377, 0.0377, 0.0248, 0.0006, 0.0002, 0.0718]
# label = [0.0215, 0.0264, 0.047, 0.0, 0.0001, 0.5088]
# krum = [0.0521, 0.0434, 0.0271, 0.2405, 0.1492, 0.0]
# mean = [0.0099, 0.0782, 0.1598, 0.2366, 0.4372, 0.0001]
# median = [0.0256, 0.0862, 0.0709, 0.0, 0.0006, 0.00]
# scaling = [0.0437, 0.0459, 0.0423, 0.0001, 0.001, 0.1472]

# median_non
# no_attack = [0.0517, 0.0401, 0.0353, 0.001, 0.0026, 0.1624]
# uncertain = [0.1423, 0.1578, 0.1946, 0.3152, 0.08662, 0.6454]
# gaussian = [0.0305, 0.0445, 0.0162, 0.2138, 0.0024, 0.0832]
# label = [0.0246, 0.0238, 0.0211, 0.0092, 0.0018, 0.0]
# krum = [0.0621, 0.0483, 0.032, 0.2113, 0.0999, 0.4337]
# mean = [0.0182, 0.0171, 0.0263, 0.2601, 0.1679, 0.0691]
# median = [0.0181, 0.0136, 0.0204, 0.0, 0.0007, 0.0941]
# scaling = [0.0321, 0.0506, 0.0287, 0.0, 0.0056, 0.4175]

# fedavg_epoch
# no_attack = [0.0334, 0.0328, 0.0326, 0.0320, 0.0318]
# uncertain = [1.0, 0.9996, 0.9812, 0.9775, 0.9774]
# gaussian = [0.0509, 0.0294, 0.0331, 0.0278, 0.0232]
# label = [0.1950, 0.0813, 0.0503, 0.0885, 0.0576]
# krum = [0.0628, 0.0396, 0.0255, 0.0195, 0.0327]
# mean = [0.4333, 0.4335, 0.0326, 0.4355, 0.0]
# median = [0.1367, 0.0202, 0.0482, 0.0346, 0.2095]
# scaling = [0.1675, 0.037, 0.0326, 0.0261, 0.0262]

# krum_epoch
# no_attack = [0.0524, 0.0520, 0.0518, 0.0517, 0.0516]
# uncertain = [0.4369, 0.4277, 0.4107, 0.3530, 0.2080]
# gaussian = [0.0369, 0.0549, 0.0361, 0.0, 0.0417]
# label = [0.4032, 0.0303, 0.1237, 0.0001, 0.0548]
# krum = [0.0014, 0.0301, 0.1739, 0.0813, 0.0045]
# mean = [0.4329, 0.0425, 0.1849, 0.0, 0.0327]
# median = [0.3110, 0.0, 0.0865, 0.0, 0.3574]
# scaling = [0.2663, 0.0, 0.0664, 0.0003, 0.0]

# mean_epoch
# no_attack = [0.0296, 0.0295, 0.0293, 0.0290, 0.0288]
# uncertain = [0.3546, 0.3421, 0.2168, 0.145, 0.1154]
# gaussian = [0.0248, 0.0306, 0.0268, 0.0257, 0.025]
# label = [0.047, 0.0523, 0.0209, 0.0302, 0.0336]
# krum = [0.0271, 0.0454, 0.0372, 0.0335, 0.0254]
# mean = [0.1598, 0.1614, 0.0305, 0.008, 0.0247]
# median = [0.0709, 0.0709, 0.1775, 0.0176, 0.189]
# scaling = [0.0423, 0.0373, 0.0318, 0.0243, 0.0307]

# median_epoch
# no_attack = [0.0353, 0.0350, 0.0345, 0.0343, 0.0342]
# uncertain = [0.2308, 0.1946, 0.1378, 0.1312, 0.1154]
# gaussian = [0.0162, 0.0378, 0.0364, 0.0241, 0.018]
# label = [0.0211, 0.0155, 0.0246, 0.2102, 0.0221]
# krum = [0.032, 0.0371, 0.0444, 0.0263, 0.0252]
# mean = [0.0263, 0.4026, 0.0242, 0.0115, 0.183]
# median = [0.0204, 0.011, 0.1167, 0.0705, 0.1292]
# scaling = [0.0287, 0.033, 0.039, 0.0273, 0.0236]

# fedavg_client_num
# no_attack = [0.0334, 0.0334, 0.0421, 0.0535, 0.0515]
# uncertain = [1.0, 1.0, 0.872, 0.9999, 0.9949]
# gaussian = [0.0509, 0.0425, 0.0328, 0.0539, 0.0483]
# label = [0.1950, 0.049, 0.0428, 0.0821, 0.0628]
# krum = [0.0628, 0.0372, 0.0469, 0.059, 0.0415]
# mean = [0.4333, 0.0102, 0.4372, 0.425, 0.0124]
# median = [0.1367, 0.0426, 0.2703, 0.1876, 0.2166]
# scaling = [0.1675, 0.0489, 0.0304, 0.0282, 0.0906]

# krum_client_num
# no_attack = [0.0524, 0.0524, 0.0571, 0.0567, 0.0721]
# uncertain = [0.4369, 0.325, 0.2155, 0.4191, 0.2176]
# gaussian = [0.0369, 0.0034, 0.0244, 0.0542, 0.0236]
# label = [0.4032, 0.049, 0.1301, 0.2052, 0.0738]
# krum = [0.0014, 0.0218, 0.0094, 0.0002, 0.0114]
# mean = [0.4329, 0.0746, 0.3781, 0.1998, 0.1829]
# median = [0.3110, 0.1178, 0.4265, 0.1498, 0.0113]
# scaling = [0.2663, 0.048, 0.3674, 0.0731, 0.0387]

# mean_client_num
# no_attack = [0.0296, 0.0296, 0.0488, 0.0533, 0.0556]
# uncertain = [0.3546, 0.3688, 0.2465, 0.439, 0.7238]
# gaussian = [0.0248, 0.0397, 0.0264, 0.0359, 0.054]
# label = [0.047, 0.0369, 0.0419, 0.154, 0.0]
# krum = [0.0271, 0.0314, 0.0238, 0.0321, 0.0327]
# mean = [0.1598, 0.0007, 0.0, 0.4361, 0.0033]
# median = [0.0709, 0.0193, 0.2876, 0.3822, 0.4375]
# scaling = [0.0423, 0.0388, 0.0335, 0.0298, 0.0375]

# median_client_num
# no_attack = [0.0353, 0.0353, 0.0353, 0.0, 0.0019]
# uncertain = [0.2308, 0.2037, 0.1921, 0.242, 0.5789]
# gaussian = [0.0162, 0.0326, 0.0282, 0.0522, 0.0445]
# label = [0.0211, 0.0903, 0.0073, 0.0, 0.0]
# krum = [0.032, 0.0278, 0.0211, 0.0352, 0.0229]
# mean = [0.0263, 0.013, 0.3057, 0.4274, 0.4346]
# median = [0.0204, 0.0008, 0.2256, 0.2336, 0.3857]
# scaling = [0.0287, 0.033, 0.0268, 0.0477, 0.0426]

# fedavg_target_label
# no_attack = [0.0411, 0.0504, 0.017, 0.0072, 0.0524, 0.0053]
# uncertain = [1.0, 1.0, 1.0, 1.0, 1.0, 0.9999]

# krum_target_label
# no_attack = [0.0504, 0.017, 0.0072, 0.0524, 0.0704, 0.0023]
# uncertain = [0.3297, 0.2176, 0.1511, 0.4369, 0.2302, 0.1803]

# mean_target_label
no_attack = [0.0396, 0.0175, 0.0035, 0.0296, 0.0444, 0.0109]
uncertain = [0.1262, 0.163, 0.1446, 0.3546, 0.1821, 0.174]

# median_target_label
# no_attack = [0.0472, 0.0176, 0.0028, 0.0353, 0.038, 0.0049]
# uncertain = [0.0941, 0.1613, 0.1353, 0.1946, 0.1625, 0.1052]

x = np.array([0, 1, 2, 3, 4, 5])
# x = np.array([0, 5, 10, 15, 20, 25])
# x = np.array([1, 2, 3, 4, 5])
plt.plot(x, no_attack, label='No attack', linestyle='--', marker='x')
plt.plot(x, uncertain, label='Our', linestyle='-.', marker='o')
# plt.plot(x, gaussian, label='Gaussian', linestyle='--', marker='.')
# plt.plot(x, label, label='LF', linestyle='--', marker='+')
# plt.plot(x, krum, label='Krum', linestyle='--', marker='1')
# plt.plot(x, mean, label='Trim', linestyle='--', marker='2')
# plt.plot(x, median, label='Median', linestyle='--', marker='3')
# plt.plot(x, scaling, label='Scaling', linestyle='--', marker='4')

ax = plt.gca()
ax.xaxis.set_major_locator(MultipleLocator(1))
plt.ylim(0, 1.01)
plt.xticks([0, 1, 2, 3, 4, 5])
# plt.xlabel('Number of Epochs of Stochastic Gradient Descent', {'size': 15})
plt.xlabel('Target Label', {'size': 14})
# plt.xlabel('Percentage of Controlled clients (%)', {'size': 14})
plt.ylabel('Poisoned Task Rate', {'size': 15})
plt.legend(loc=0, ncol=1, handlelength=3, fontsize=15)
plt.tick_params(labelsize=15)
plt.grid(linestyle='--')

plt.savefig('C:/Users/lxy/Desktop/img/mean_target_label.pdf')
plt.show()
